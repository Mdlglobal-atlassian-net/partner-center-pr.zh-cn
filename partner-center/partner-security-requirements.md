---
title: 合作伙伴安全要求 | 合作伙伴中心
ms.topic: article
ms.date: 08/30/2019
description: 了解对参与云解决方案提供商计划的顾问和合作伙伴的安全要求。
author: isaiahwilliams
ms.author: iswillia
keywords: Azure Active Directory, 云解决方案提供商, 云解决方案提供商计划, CSP, 控制面板供应商, CPV, 多重身份验证, MFA, 安全应用程序模型, 安全应用模型, 安全性
ms.localizationpriority: medium
ms.openlocfilehash: c95ec38f928ca4032ffecebaf25f23e87d10c079
ms.sourcegitcommit: de3cdc792b6b4bbc64d1288d371623d79d535205
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/03/2019
ms.locfileid: "70215651"
---
# <a name="partner-security-requirements"></a><span data-ttu-id="11412-104">合作伙伴安全要求</span><span class="sxs-lookup"><span data-stu-id="11412-104">Partner Security Requirements</span></span>

<span data-ttu-id="11412-105">**适用于**</span><span class="sxs-lookup"><span data-stu-id="11412-105">**Applies to**</span></span>

- <span data-ttu-id="11412-106">云解决方案提供商计划中的所有合作伙伴</span><span class="sxs-lookup"><span data-stu-id="11412-106">All partners in the Cloud Solution Provider program</span></span>
  - <span data-ttu-id="11412-107">直接计费</span><span class="sxs-lookup"><span data-stu-id="11412-107">Direct bill</span></span>
  - <span data-ttu-id="11412-108">间接提供商</span><span class="sxs-lookup"><span data-stu-id="11412-108">Indirect provider</span></span>
  - <span data-ttu-id="11412-109">间接经销商</span><span class="sxs-lookup"><span data-stu-id="11412-109">Indirect reseller</span></span>
- <span data-ttu-id="11412-110">所有控制面板供应商</span><span class="sxs-lookup"><span data-stu-id="11412-110">All Control Panel Vendors</span></span>
- <span data-ttu-id="11412-111">所有顾问</span><span class="sxs-lookup"><span data-stu-id="11412-111">All Advisors</span></span>

<span data-ttu-id="11412-112">增强隐私保护和安全性是我们优先关注的事项。</span><span class="sxs-lookup"><span data-stu-id="11412-112">Greater privacy safeguards and security are among our top priorities.</span></span> <span data-ttu-id="11412-113">我们知道，最好的防御措施是防患于未然，链条的强度取决于其最弱的一环。</span><span class="sxs-lookup"><span data-stu-id="11412-113">We know that the best defense is prevention and that we are only as strong as our weakest link.</span></span> <span data-ttu-id="11412-114">因此，我们需要生态系统中的所有人都行动起来，确保将安全保护措施实施到位。</span><span class="sxs-lookup"><span data-stu-id="11412-114">That is why we need everyone in our ecosystem to act and ensure they have appropriate security protections in place.</span></span> <span data-ttu-id="11412-115">为了保护合作伙伴和客户，我们引入了一系列强制性安全要求，针对那些参与云解决方案提供商计划的顾问、控制面板供应商和合作伙伴。</span><span class="sxs-lookup"><span data-stu-id="11412-115">To help safeguard partners and customers, we’re introducing a set of mandatory security requirements for Advisors, Control Panel Vendors, and partners participating in the Cloud Solution Provider program.</span></span>

<span data-ttu-id="11412-116">从 2019 年 8 月 1 日开始，所有合作伙伴都必须对其合作伙伴租户中的所有用户（包括服务帐户）强制实施多重身份验证。</span><span class="sxs-lookup"><span data-stu-id="11412-116">Starting August 1, 2019 all partners are required to enforce multi-factor authentication for all users, including service accounts, in their partner tenant.</span></span>

> [!NOTE]
> <span data-ttu-id="11412-117">强烈建议所有通过主权云（世纪互联、Microsoft Cloud for US Government、德国 Microsoft 云）进行事务处理的合作伙伴立即行动起来，履行这些安全要求。</span><span class="sxs-lookup"><span data-stu-id="11412-117">We strongly recommend that all partners transacting through a sovereign cloud (21Vianet, US Government, and Germany) act and adopt these new security requirements immediately.</span></span> <span data-ttu-id="11412-118">但是，这些合作伙伴不是必须满足这些新的在 2019 年 8 月 1 日生效的安全要求。</span><span class="sxs-lookup"><span data-stu-id="11412-118">However, these partners are not required to meet the new security requirements effective August 1, 2019.</span></span> <span data-ttu-id="11412-119">Microsoft 会在以后更详细地说明如何强制实施这些针对主权云的安全要求。</span><span class="sxs-lookup"><span data-stu-id="11412-119">Microsoft will provide additional details regarding the enforcement of these security requirements for sovereign clouds in the future.</span></span>

<span data-ttu-id="11412-120">与合作伙伴安全要求相关的条款已添加到[云解决方案提供商计划指南](https://go.microsoft.com/fwlink/p/?LinkId=617100)中。</span><span class="sxs-lookup"><span data-stu-id="11412-120">The terms associated with the partner security requirements have been added to the [Cloud Solution Provider program guide](https://go.microsoft.com/fwlink/p/?LinkId=617100).</span></span> <span data-ttu-id="11412-121">从 2019 年 8 月 1 日起，所有参与云解决方案提供商计划的合作伙伴都应遵守这些条款。</span><span class="sxs-lookup"><span data-stu-id="11412-121">Starting on August 1, 2019 all partners participating in the Cloud Solution Provider program should be in compliance with the terms.</span></span> <span data-ttu-id="11412-122">由于与顾问相关，因此会实施相同的合同要求。</span><span class="sxs-lookup"><span data-stu-id="11412-122">As it relates to Advisors the same contractual requirements will be in place.</span></span>

<span data-ttu-id="11412-123">一旦我们强制实施这些安全要求，不实施这些强制性要求的合作伙伴将不能在云解决方案提供商计划中进行事务处理，也不能利用委托管理权限来管理客户租户。</span><span class="sxs-lookup"><span data-stu-id="11412-123">Partners who do not implement the mandatory security requirements will not be able to transact in the Cloud Solution Provider program or manage customer tenants leveraging delegate admin rights, once these requirements are enforced.</span></span> <span data-ttu-id="11412-124">我们准备针对这些要求确定一个严格的强制实施日期，并且会将该日期和相关详细信息告知合作伙伴。</span><span class="sxs-lookup"><span data-stu-id="11412-124">We are in the process of establishing a technical enforcement date for the requirements and will notify partners of the date with detailed information.</span></span>

## <a name="what-actions-do-i-need-to-take"></a><span data-ttu-id="11412-125">我需要采取什么行动？</span><span class="sxs-lookup"><span data-stu-id="11412-125">What actions do I need to take?</span></span>

<span data-ttu-id="11412-126">考虑到合作伙伴会有很高的特权，因此我们需要确保在每位用户每次进行身份验证时都对其进行 MFA 质询。</span><span class="sxs-lookup"><span data-stu-id="11412-126">Given the highly privileged nature of being a partner we need to ensure that each user has an MFA challenge for every single authentication.</span></span> <span data-ttu-id="11412-127">可以通过下述方式之一来实现这一点：</span><span class="sxs-lookup"><span data-stu-id="11412-127">This can be accomplished through one of the following ways</span></span>

- <span data-ttu-id="11412-128">实现 Azure AD Premium，确保为每位用户强制实施 MFA</span><span class="sxs-lookup"><span data-stu-id="11412-128">Implementing Azure AD Premium and ensure that MFA is enforced for each user</span></span>
- <span data-ttu-id="11412-129">实现[基线保护策略](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection)</span><span class="sxs-lookup"><span data-stu-id="11412-129">Implementing the [baseline protection policies](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection)</span></span>
- <span data-ttu-id="11412-130">实现第三方解决方案，确保为每位用户强制实施 MFA</span><span class="sxs-lookup"><span data-stu-id="11412-130">Implementing a third-party solution and ensure MFA is enforced for each user</span></span>

> [!IMPORTANT]
> <span data-ttu-id="11412-131">严格实施这些要求以后，每一项身份验证都必须进行 MFA 质询。</span><span class="sxs-lookup"><span data-stu-id="11412-131">Once these requirements are technically enforced every single authentication must have an MFA challenge.</span></span> <span data-ttu-id="11412-132">你将无法使用条件访问的任何功能来避免在访问 Microsoft 商业云服务时使用 MFA 进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="11412-132">You will not be able to use any feature of conditional access to avoid authenticating using MFA when access Microsoft commercial cloud services.</span></span>

### <a name="considerations"></a><span data-ttu-id="11412-133">注意事项</span><span class="sxs-lookup"><span data-stu-id="11412-133">Considerations</span></span>

<span data-ttu-id="11412-134">由于这些要求适用于合作伙伴租户中的所有用户（包括服务帐户），因此需要遵守一些注意事项，确保顺利进行部署。</span><span class="sxs-lookup"><span data-stu-id="11412-134">Because these requirements apply to all users, including service accounts, in your partner tenant, there are several considerations that need to be made to ensure a smooth deployment.</span></span> <span data-ttu-id="11412-135">这些注意事项包括确定 Azure AD 中不能执行 MFA 的用户，以及组织所使用的不支持新式身份验证的应用程序和设备。</span><span class="sxs-lookup"><span data-stu-id="11412-135">These considerations include identifying users in Azure AD that cannot perform MFA, as well as applications and devices used by your organization that do not support modern authentication.</span></span>

<span data-ttu-id="11412-136">建议在执行任何操作之前确定以下事项：</span><span class="sxs-lookup"><span data-stu-id="11412-136">Prior to performing any action, it is recommended that you identify the following</span></span>

#### <a name="do-you-have-an-application-or-device-that-does-not-support-the-use-of-mfa-when-authenticating"></a><span data-ttu-id="11412-137">你是否有进行身份验证时不支持使用 MFA 的应用程序或设备？</span><span class="sxs-lookup"><span data-stu-id="11412-137">Do you have an application or device that does not support the use of MFA when authenticating?</span></span>

<span data-ttu-id="11412-138">强制实施 MFA 时，系统会阻止旧版身份验证协议（例如 IMAP、POP3、SMTP 等）的使用，因为这些协议不支持 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-138">When you enforce MFA legacy authentication use protocols such as IMAP, POP3, SMTP, etc. will be blocked because these protocols do not support MFA.</span></span> <span data-ttu-id="11412-139">为了解决此限制问题，可以使用名为[应用密码](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings#app-passwords)的功能，确保应用程序或设备仍然能够进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="11412-139">To address this limitation a feature known as [app passwords](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings#app-passwords) can be used to ensure the application or device can still authenticate.</span></span> <span data-ttu-id="11412-140">你应该查看[此处](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings#considerations-about-app-passwords)记录的应用密码使用注意事项，确定应用密码是否可以在你的环境中使用。</span><span class="sxs-lookup"><span data-stu-id="11412-140">You should review the considerations for using app passwords documented [here](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings#considerations-about-app-passwords) to determine if they can be used in your environment.</span></span>

#### <a name="do-you-have-users-using-office-365-provided-by-licenses-associated-with-your-partner-tenant"></a><span data-ttu-id="11412-141">你是否有用户使用通过与合作伙伴租户相关联的许可证获得的 Office 365？</span><span class="sxs-lookup"><span data-stu-id="11412-141">Do you have users using Office 365 provided by licenses associated with your partner tenant?</span></span>

<span data-ttu-id="11412-142">在实现任何解决方案之前，建议你确定合作伙伴租户中的用户所使用的 Microsoft Office 版本。</span><span class="sxs-lookup"><span data-stu-id="11412-142">Prior to implementing any solution, it is recommended that you determine why version of Microsoft Office is being used by users in your partner tenant.</span></span> <span data-ttu-id="11412-143">在采取任何行动之前，请参阅 [Office 365 部署的多重身份验证计划](https://docs.microsoft.com/office365/admin/security-and-compliance/multi-factor-authentication-plan#enable-mfa)。</span><span class="sxs-lookup"><span data-stu-id="11412-143">Review [plan for multi-factor authentication for Office 365 Deployments](https://docs.microsoft.com/office365/admin/security-and-compliance/multi-factor-authentication-plan#enable-mfa) before taking any action.</span></span> <span data-ttu-id="11412-144">用户可能会在使用 Outlook 之类的应用程序时遇到连接问题。</span><span class="sxs-lookup"><span data-stu-id="11412-144">There is a chance your users will experience connectivity issues with applications like Outlook.</span></span> <span data-ttu-id="11412-145">在强制实施 MFA 之前，必须确保使用的是 Outlook 2013 SP1 或更高版本，且组织已启用新式身份验证。</span><span class="sxs-lookup"><span data-stu-id="11412-145">Before enforcing MFA, it important to ensure that Outlook 2013 SP1, or later, is being used and that your organization has modern authentication enabled.</span></span> <span data-ttu-id="11412-146">有关详细信息，请参阅[在 Exchange Online 中启用新式身份验证](https://docs.microsoft.com/exchange/clients-and-mobile-in-exchange-online/enable-or-disable-modern-authentication-in-exchange-online)。</span><span class="sxs-lookup"><span data-stu-id="11412-146">See [Enable modern authentication in Exchange Online](https://docs.microsoft.com/exchange/clients-and-mobile-in-exchange-online/enable-or-disable-modern-authentication-in-exchange-online) for more information.</span></span>

<span data-ttu-id="11412-147">若要为任何运行 Windows 且已安装 Microsoft Office 2013 的设备启用新式身份验证，需创建两个注册表项。</span><span class="sxs-lookup"><span data-stu-id="11412-147">To enable modern authentication for any devices running Windows, that have Microsoft Office 2013 installed, you will need to create two registry keys.</span></span> <span data-ttu-id="11412-148">请参阅[在 Windows 设备上启用适用于 Office 2013 的新式身份验证](https://docs.microsoft.com/office365/admin/security-and-compliance/enable-modern-authentication)。</span><span class="sxs-lookup"><span data-stu-id="11412-148">See [Enable Modern Authentication for Office 2013 on Windows devices](https://docs.microsoft.com/office365/admin/security-and-compliance/enable-modern-authentication).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="11412-149">如果已为用户启用 Azure AD MFA，但他们有一些运行 Office 2013 的设备未启用新式身份验证，则他们需要在这些设备上使用应用密码。</span><span class="sxs-lookup"><span data-stu-id="11412-149">If you have enabled your users for Azure AD MFA and they have any devices running Office 2013 that are not enabled for modern authentication, they will need to use App Passwords on those devices.</span></span> <span data-ttu-id="11412-150">若要详细了解应用密码以及应该在何时、何处以何种方式使用它们，可参阅：[应用密码与 Azure 多重身份验证](https://go.microsoft.com/fwlink/p/?LinkId=528178)。</span><span class="sxs-lookup"><span data-stu-id="11412-150">More information on App Passwords and when/where/how they should be used can be found here: [App Passwords with Azure Multi-Factor Authentication](https://go.microsoft.com/fwlink/p/?LinkId=528178).</span></span>

#### <a name="is-there-a-policy-preventing-any-of-your-users-from-using-their-mobile-devices-while-working"></a><span data-ttu-id="11412-151">是否有策略阻止用户在工作时使用其移动设备？</span><span class="sxs-lookup"><span data-stu-id="11412-151">Is there a policy preventing any of your users from using their mobile devices while working?</span></span>

<span data-ttu-id="11412-152">必须确定任何阻止员工在工作时使用移动设备的公司策略，因为它会影响你实现的具体的 MFA 解决方案。</span><span class="sxs-lookup"><span data-stu-id="11412-152">It is important to identify any corporate policy that prevents employees from using mobile devices while working because it will influence what MFA solution you implement.</span></span> <span data-ttu-id="11412-153">有的 MFA 解决方案（例如通过实施[基线保护策略](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection)提供的解决方案）仅允许使用 Authenticator 应用进行验证。</span><span class="sxs-lookup"><span data-stu-id="11412-153">There are MFA solutions, such as the one provided through the implementation of the [baseline protection policies](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection), that only allow the use of an authenticator app for verification.</span></span> <span data-ttu-id="11412-154">如果组织的某项策略阻止使用移动设备，则应考虑以下选项之一：</span><span class="sxs-lookup"><span data-stu-id="11412-154">In the event your organization has a policy that prevent the use of mobile devices, then you should consider one of the following options</span></span>

- <span data-ttu-id="11412-155">部署可以在安全系统上运行的基于时间的一次性密码 (TOTP) 应用程序</span><span class="sxs-lookup"><span data-stu-id="11412-155">Deploy a time-based one-time base password (TOTP) application that can run on secure system</span></span>
- <span data-ttu-id="11412-156">实现第三方解决方案，为合作伙伴租户中的每位用户强制实施 MFA，以便提供最适当的验证选项</span><span class="sxs-lookup"><span data-stu-id="11412-156">Implement a third-party solution that enforces MFA for each user in the partner tenant that provides the most appropriate verification option</span></span>
- <span data-ttu-id="11412-157">为受影响的用户购买 [Azure AD Premium](https://azure.microsoft.com/pricing/details/active-directory/) 许可证</span><span class="sxs-lookup"><span data-stu-id="11412-157">Purchasing [Azure AD Premium](https://azure.microsoft.com/pricing/details/active-directory/) licenses for the impacted users</span></span>

<span data-ttu-id="11412-158">对 FIDO 安全密钥的使用支持已经列入基线保护策略的路线图。</span><span class="sxs-lookup"><span data-stu-id="11412-158">Support for the use of FIDO security keys is on the road map for the baseline protection policies.</span></span> <span data-ttu-id="11412-159">添加支持后，即可利用 FIDO 安全密钥进行双重身份验证。</span><span class="sxs-lookup"><span data-stu-id="11412-159">Once support has been added, you will be able to leverage FIDO security keys for the second factor of authentication.</span></span> <span data-ttu-id="11412-160">在此之前，只能使用 Authenticator 应用。</span><span class="sxs-lookup"><span data-stu-id="11412-160">Until then you are limited to the use of the Authenticator App.</span></span>

#### <a name="what-automation-or-integration-do-you-have-that-leverages-user-credentials-for-authentication"></a><span data-ttu-id="11412-161">你有什么样的利用用户凭据进行身份验证的自动化或集成？</span><span class="sxs-lookup"><span data-stu-id="11412-161">What automation or integration do you have that leverages user credentials for authentication?</span></span>

<span data-ttu-id="11412-162">由于此要求是对合作伙伴目录中的每位用户（包括服务帐户）强制实施 MFA，因此任何利用用户凭据进行身份验证的自动化或集成都会受影响。</span><span class="sxs-lookup"><span data-stu-id="11412-162">Since the requirement is to enforce MFA for each user, including service accounts, in your partner directory any automation or integration that leverages user credentials for authentication will be impacted.</span></span> <span data-ttu-id="11412-163">因此，必须确定在这些情况下使用的是什么帐户。</span><span class="sxs-lookup"><span data-stu-id="11412-163">So, it important that you identify what accounts are being used in these situations.</span></span> <span data-ttu-id="11412-164">下面是一个列表，其中包含应该考虑的应用程序或服务的示例：</span><span class="sxs-lookup"><span data-stu-id="11412-164">The following is a list of examples of applications or services that should be considered</span></span>

- <span data-ttu-id="11412-165">控制面板，用于代表客户预配资源</span><span class="sxs-lookup"><span data-stu-id="11412-165">Control panel used to provision resources on behalf of your customers</span></span>
- <span data-ttu-id="11412-166">与任何用于客户发票（由于与 CSP 计划相关）和支持的平台的集成</span><span class="sxs-lookup"><span data-stu-id="11412-166">Integration with any platform that is used for invoicing (as it relates to the CSP program) and supporting your customers</span></span>
- <span data-ttu-id="11412-167">利用 Az、AzureRM、Azure AD、MS Online 等模块的 PowerShell 脚本</span><span class="sxs-lookup"><span data-stu-id="11412-167">PowerShell scripts that utilize the Az, AzureRM, Azure AD, MS Online, etc. modules</span></span>

<span data-ttu-id="11412-168">以上列表并不完整。</span><span class="sxs-lookup"><span data-stu-id="11412-168">The above list is not comprehensive.</span></span> <span data-ttu-id="11412-169">因此，必须对环境中利用用户凭据进行身份验证的任何应用程序或服务进行完整的评估。</span><span class="sxs-lookup"><span data-stu-id="11412-169">So, it important that you perform a complete assessment of any application or service in your environment that leverages user credentials for authentication.</span></span> <span data-ttu-id="11412-170">在可能情况下，应该按[安全应用程序模型框架](https://docs.microsoft.com/partner-center/develop/enable-secure-app-model)中的指南（不同于 MFA 的要求）进行操作。</span><span class="sxs-lookup"><span data-stu-id="11412-170">To contend with the requirement for MFA, you should implement the guidance in the [Secure Application Model framework](https://docs.microsoft.com/partner-center/develop/enable-secure-app-model) where possible.</span></span> <span data-ttu-id="11412-171">下面是其他资源，介绍如何实现安全应用程序模型框架：</span><span class="sxs-lookup"><span data-stu-id="11412-171">The following are additional resources that will help you understand how the Secure Application Model framework can be implemented</span></span>

- <span data-ttu-id="11412-172">[Partner Center .NET Samples](https://github.com/microsoft/partner-center-dotnet-samples)（合作伙伴中心 .NET 示例） - 此 GitHub 存储库包含使用 .NET 开发的示例，用于演示如何实现安全应用程序模型框架。</span><span class="sxs-lookup"><span data-stu-id="11412-172">[Partner Center .NET Samples](https://github.com/microsoft/partner-center-dotnet-samples) - This GitHub repository contains samples, developed using .NET, that will demonstrate how you can implement the Secure Application Model framework.</span></span>
- <span data-ttu-id="11412-173">[合作伙伴中心 Java 示例](https://github.com/microsoft/partner-center-java-samples) - 此 GitHub 存储库包含使用 Java 开发的示例，用于演示如何实现安全应用程序模型框架。</span><span class="sxs-lookup"><span data-stu-id="11412-173">[Partner Center Java Samples](https://github.com/microsoft/partner-center-java-samples) - This GitHub repository contains samples, developed using Java, that will demonstrate how you can implement the Secure Application Model framework.</span></span>
- <span data-ttu-id="11412-174">[合作伙伴中心 PowerShell - 安全应用程序模型](https://docs.microsoft.com/powershell/partnercenter/secure-app-model) - 这是一篇详述如何使用 PowerShell 实现安全应用程序模型框架的文章。</span><span class="sxs-lookup"><span data-stu-id="11412-174">[Partner Center PowerShell - Secure Application Model](https://docs.microsoft.com/powershell/partnercenter/secure-app-model) - This is an article that provides details on how to implement the Secure Application Model framework using PowerShell.</span></span>
- <span data-ttu-id="11412-175">[合作伙伴中心安全指南组社区](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance) - 这是一个在线社区，你可以在其中了解即将发生的事件并提问任何问题。</span><span class="sxs-lookup"><span data-stu-id="11412-175">[Partner Center Security Guidance Group community](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance) - This is online community where you can learn about upcoming events and ask any questions that you might have.</span></span>

### <a name="enforcing-mfa-for-all-users"></a><span data-ttu-id="11412-176">对所有用户强制实施 MFA</span><span class="sxs-lookup"><span data-stu-id="11412-176">Enforcing MFA for all users</span></span>

<span data-ttu-id="11412-177">此部分介绍如何使用[基线保护策略](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection)为合作伙伴租户中的每位用户（包括服务帐户）强制实施 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-177">This section will cover how you can use the [baseline protection policies](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection) to enforce MFA for each user, including service accounts, in your partner tenant.</span></span> <span data-ttu-id="11412-178">如果打算使用 Azure AD Premium，则请执行[此处](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-getstarted)记录的步骤。</span><span class="sxs-lookup"><span data-stu-id="11412-178">If you are planning to use Azure AD Premium, then follow the steps documented [here](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-getstarted).</span></span>

> [!NOTE]
> <span data-ttu-id="11412-179">可以使用与 Azure AD 兼容的第三方解决方案为所有用户（包括服务帐户）强制实施 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-179">A third-party solution, that is compatible with Azure AD, can be used to enforce MFA for all users, including, service accounts.</span></span> <span data-ttu-id="11412-180">请参阅供应商文档，更详细地了解应该如何实现此解决方案。</span><span class="sxs-lookup"><span data-stu-id="11412-180">Refer to the documentation from the vendor for more details on how the solution should be implemented.</span></span>

<span data-ttu-id="11412-181">基线保护策略是一组预定义的策略，可帮助组织防范许多常见攻击。</span><span class="sxs-lookup"><span data-stu-id="11412-181">Baseline protection policies are a set of predefined policies that help protect organizations against many common attacks.</span></span> <span data-ttu-id="11412-182">这些常见攻击可能包括密码喷射、重播和钓鱼。</span><span class="sxs-lookup"><span data-stu-id="11412-182">These common attacks can include password spray, replay, and phishing.</span></span> <span data-ttu-id="11412-183">基线保护策略在所有版本的 Azure Active Directory 中提供。</span><span class="sxs-lookup"><span data-stu-id="11412-183">Baseline protection policies are available in all editions of Azure Active Directory.</span></span> <span data-ttu-id="11412-184">Microsoft 会将这些基线保护策略提供给所有人，从而让客户和合作伙伴可以实施最佳安全做法。</span><span class="sxs-lookup"><span data-stu-id="11412-184">Microsoft is making these baseline protection policies available to everyone to further enable customers and partners to implement best-in-class security practices.</span></span>

<span data-ttu-id="11412-185">下表介绍了应该启用的两种基线保护策略。</span><span class="sxs-lookup"><span data-stu-id="11412-185">The two baseline protection policies that should be enabled are described in the table below.</span></span>

|<span data-ttu-id="11412-186">**策略**</span><span class="sxs-lookup"><span data-stu-id="11412-186">**Policy**</span></span>| |
|-----|-----|
|<span data-ttu-id="11412-187">**对管理员要求 MFA**</span><span class="sxs-lookup"><span data-stu-id="11412-187">**Require MFA for admins**</span></span>|<span data-ttu-id="11412-188">启用“对管理员要求 MFA”策略以后，担任管理员角色的用户就必须使用 Authenticator 应用注册 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-188">Enabling the Require MFA for admins policy, will require users in the administrator roles to register for MFA using the Authenticator App.</span></span> <span data-ttu-id="11412-189">完成 MFA 注册以后，管理员在每次登录时都需要执行 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-189">Once MFA registration is complete, administrators will need to perform MFA every time they sign-in.</span></span>|
|<span data-ttu-id="11412-190">**最终用户保护**</span><span class="sxs-lookup"><span data-stu-id="11412-190">**End user protection**</span></span>|<span data-ttu-id="11412-191">“最终用户保护”是一种基于风险的 MFA 基线保护策略，用于保护目录中的所有用户。</span><span class="sxs-lookup"><span data-stu-id="11412-191">End user protection is a risk-based MFA baseline protection policy that protects all users in a directory.</span></span> <span data-ttu-id="11412-192">启用此策略以后，所有用户就必须使用 Authenticator 应用注册 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-192">Enabling this policy requires all users to register for MFA using the Authenticator App.</span></span> <span data-ttu-id="11412-193">用户可以忽略 MFA 注册提示 14 天，此期限过后系统会阻止用户登录，直至用户注册 MFA 为止。</span><span class="sxs-lookup"><span data-stu-id="11412-193">Users can ignore the MFA registration prompt for 14 days, after which they will be blocked from signing in until they register for MFA.</span></span> <span data-ttu-id="11412-194">注册 MFA 以后，系统仅在检测到风险登录尝试时提示用户进行 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-194">Once registered for MFA, users will be prompted for MFA only during risky sign-in attempts.</span></span> <span data-ttu-id="11412-195">系统会阻止被盗用的用户帐户，直至用户重置密码并消除风险事件为止。</span><span class="sxs-lookup"><span data-stu-id="11412-195">Compromised user accounts are blocked until their password is reset and risk events have been dismissed.</span></span>|

<span data-ttu-id="11412-196">启用这些策略后，每位用户就能够使用 Azure MFA，通过 Authenticator 应用进行验证，不需额外付费。</span><span class="sxs-lookup"><span data-stu-id="11412-196">When these policies are enabled, each user will be able to utilize Azure MFA using the Authenticator App for verification at no additional cost.</span></span>

#### <a name="configure-self-service-password-reset"></a><span data-ttu-id="11412-197">配置自助式密码重置</span><span class="sxs-lookup"><span data-stu-id="11412-197">Configure Self Service Password Reset</span></span>

<span data-ttu-id="11412-198">自助式密码重置 (SSPR) 是一项 Azure Active Directory 功能，该功能允许用户重置其密码而不需联系其支持团队。</span><span class="sxs-lookup"><span data-stu-id="11412-198">Self-service password reset (SSPR) is an Azure Active Directory feature that enables users to reset their passwords without needing to contact their support team.</span></span> <span data-ttu-id="11412-199">用户必须主动或被动注册自助式密码重置，然后才能使用此服务。</span><span class="sxs-lookup"><span data-stu-id="11412-199">Users must register for or be registered for self-service password reset before using the service.</span></span> <span data-ttu-id="11412-200">在注册期间，用户可以选择其组织启用的一个或多个身份验证方法。</span><span class="sxs-lookup"><span data-stu-id="11412-200">During registration, the user chooses one or more authentication methods enabled by their organization.</span></span>

<span data-ttu-id="11412-201">启用[最终用户保护](https://docs.microsoft.com/azure/active-directory/conditional-access/howto-baseline-protect-end-users)基线保护策略以后，系统会阻止被盗用的任何用户帐户，直至用户重置密码并消除风险事件为止。</span><span class="sxs-lookup"><span data-stu-id="11412-201">When the [End user protection](https://docs.microsoft.com/azure/active-directory/conditional-access/howto-baseline-protect-end-users) baseline protection policy is enabled, any compromised user accounts will be blocked until their password is reset and the risk events have been dismissed.</span></span> <span data-ttu-id="11412-202">考虑到这一点，建议每位全局管理员用户通过以下操作注册 SSPR，防止被系统阻止进入。</span><span class="sxs-lookup"><span data-stu-id="11412-202">Considering this it is recommended that each user, who is a global admin, perform the following to register for SSPR so they do not get locked out.</span></span>

1. <span data-ttu-id="11412-203">浏览到 [SSPR 设置页](https://aka.ms/ssprsetup)</span><span class="sxs-lookup"><span data-stu-id="11412-203">Browse to the [SSPR setup page](https://aka.ms/ssprsetup)</span></span>
2. <span data-ttu-id="11412-204">输入用户名和密码</span><span class="sxs-lookup"><span data-stu-id="11412-204">Enter your username and password</span></span>
3. <span data-ttu-id="11412-205">配置至少一个验证选项。当你重置密码时，系统会使用这些选项进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="11412-205">Configure at least one of the verifications options that will be used to verify who you are when resetting your password.</span></span>  

<span data-ttu-id="11412-206">如果某个帐户被盗用，管理员需采取措施还原受影响用户的访问权限。</span><span class="sxs-lookup"><span data-stu-id="11412-206">When an account has been compromised an administrator will need to take action to restore access for the impacted user.</span></span> <span data-ttu-id="11412-207">请参阅[取消阻止用户的步骤](#recovering-compromised-accounts)，详细了解取消阻止用户的过程。</span><span class="sxs-lookup"><span data-stu-id="11412-207">See the [steps to unblock a user](#recovering-compromised-accounts) for details on the process to unblock the user.</span></span>

#### <a name="require-mfa-for-admins"></a><span data-ttu-id="11412-208">对管理员要求 MFA</span><span class="sxs-lookup"><span data-stu-id="11412-208">Require MFA for admins</span></span>

<span data-ttu-id="11412-209">“对管理员要求 MFA”基线策略要求对以下目录角色进行 MFA，这些角色是特权最高的 Azure Active Directory 角色： </span><span class="sxs-lookup"><span data-stu-id="11412-209">The *Require MFA for admin* baseline policy requires MFA for the following directory roles, considered to be the most privileged Azure Active Directory roles:</span></span>

- <span data-ttu-id="11412-210">全局管理员</span><span class="sxs-lookup"><span data-stu-id="11412-210">Global administrator</span></span>
- <span data-ttu-id="11412-211">SharePoint 管理员</span><span class="sxs-lookup"><span data-stu-id="11412-211">SharePoint administrator</span></span>
- <span data-ttu-id="11412-212">Exchange 管理员</span><span class="sxs-lookup"><span data-stu-id="11412-212">Exchange administrator</span></span>
- <span data-ttu-id="11412-213">条件访问管理员</span><span class="sxs-lookup"><span data-stu-id="11412-213">Conditional access administrator</span></span>
- <span data-ttu-id="11412-214">安全管理员</span><span class="sxs-lookup"><span data-stu-id="11412-214">Security administrator</span></span>
- <span data-ttu-id="11412-215">支持管理员/密码管理员</span><span class="sxs-lookup"><span data-stu-id="11412-215">Helpdesk administrator / Password administrator</span></span>
- <span data-ttu-id="11412-216">帐务管理员</span><span class="sxs-lookup"><span data-stu-id="11412-216">Billing administrator</span></span>
- <span data-ttu-id="11412-217">用户管理员</span><span class="sxs-lookup"><span data-stu-id="11412-217">User administrator</span></span>

<span data-ttu-id="11412-218">启用“对管理员要求 MFA”策略以后，以上九种管理员角色就必须使用 Authenticator 应用注册 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-218">Upon enabling the Require MFA for admins policy, the above nine administrator roles will be required to register for MFA using the Authenticator App.</span></span> <span data-ttu-id="11412-219">完成 MFA 注册以后，管理员在每次登录时都需要执行 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-219">Once MFA registration is complete, administrators will need to perform MFA every single time they sign-in.</span></span>

<span data-ttu-id="11412-220">如果组织在脚本或代码中使用这些帐户，请考虑将其替换为 [托管标识](https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview)。</span><span class="sxs-lookup"><span data-stu-id="11412-220">If your organization has these accounts in use in scripts or code, consider replacing them with [managed identities](https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview).</span></span>

<span data-ttu-id="11412-221">若要启用此策略并保护管理员，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="11412-221">To enable this policy and protect your administrators:</span></span>

1. <span data-ttu-id="11412-222">以全局管理员、安全管理员或条件访问管理员身份登录到 **Azure 门户** 。</span><span class="sxs-lookup"><span data-stu-id="11412-222">Sign in to the **Azure portal** as a Global Administrator, Security Administrator, or Conditional Access Administrator.</span></span>
2. <span data-ttu-id="11412-223">浏览到“Azure Active Directory”   >   “条件访问”。</span><span class="sxs-lookup"><span data-stu-id="11412-223">Browse to **Azure Active Directory** > **Conditional Access**.</span></span>
3. <span data-ttu-id="11412-224">在策略列表中，选择“基线策略:  对管理员要求 MFA”。</span><span class="sxs-lookup"><span data-stu-id="11412-224">In the list of policies, select **Baseline policy: Require MFA for admins**.</span></span>
4. <span data-ttu-id="11412-225">将“启用策略”设置为“立即使用策略”。  </span><span class="sxs-lookup"><span data-stu-id="11412-225">Set **Enable policy** to **Use policy immediately**.</span></span>
5. <span data-ttu-id="11412-226">单击“保存”。 \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="11412-226">Click **Save**.</span></span>

> [!WARNING]
> <span data-ttu-id="11412-227">在启用此策略之前，请确保用户使用的不是旧版身份验证协议。</span><span class="sxs-lookup"><span data-stu-id="11412-227">Before you enable this policy, make sure your users are not using legacy authentication protocols.</span></span> <span data-ttu-id="11412-228">实施此策略以后，系统会阻止旧版身份验证。</span><span class="sxs-lookup"><span data-stu-id="11412-228">Through the implementation of this policy legacy authentication will be blocked.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="11412-229">这是已知问题，会影响你使用委派的管理权限连接到 Exchange Online PowerShell。</span><span class="sxs-lookup"><span data-stu-id="11412-229">There is a known issue, that impacts your ability to connect to Exchange Online PowerShell using delegated administrative privileges.</span></span> <span data-ttu-id="11412-230">如果使用该 PowerShell 模块，请在启用此策略之前查看 [Exchange Online PowerShell](#exchange-online-powershell) 已知问题。</span><span class="sxs-lookup"><span data-stu-id="11412-230">See the [Exchange Online PowerShell](#exchange-online-powershell) known issue prior to enabling this policy if you using this PowerShell module.</span></span>

#### <a name="end-user-protection"></a><span data-ttu-id="11412-231">最终用户保护</span><span class="sxs-lookup"><span data-stu-id="11412-231">End user protection</span></span>

<span data-ttu-id="11412-232">“最终用户保护”基线策略保护目录中的所有用户。</span><span class="sxs-lookup"><span data-stu-id="11412-232">The End user protection baseline policy protects all users in a directory.</span></span> <span data-ttu-id="11412-233">启用此策略以后，所有用户就必须在 14 天内注册 Azure MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-233">Enabling this policy requires all users to register for Azure MFA within 14 days.</span></span> <span data-ttu-id="11412-234">注册以后，系统仅在检测到风险登录尝试时提示用户进行 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-234">Once registered, users will be prompted for MFA only during risky sign-in attempts.</span></span> <span data-ttu-id="11412-235">系统会阻止被盗用的用户帐户，直至用户重置密码并消除风险为止。</span><span class="sxs-lookup"><span data-stu-id="11412-235">Compromised user accounts are blocked until password reset and risk dismissal.</span></span>

<span data-ttu-id="11412-236">“基线策略:  最终用户保护”策略已预先配置。当你在 Azure 门户中导航到“条件访问”边栏选项卡时，会在顶部看到它。</span><span class="sxs-lookup"><span data-stu-id="11412-236">The policy **Baseline policy: End user protection** comes pre-configured and will show up at the top when you navigate to the Conditional Access blade in Azure portal.</span></span>

<span data-ttu-id="11412-237">若要启用此策略并保护用户，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="11412-237">To enable this policy and protect your users:</span></span>

1. <span data-ttu-id="11412-238">以全局管理员、安全管理员或条件访问管理员身份登录到 **Azure 门户**。</span><span class="sxs-lookup"><span data-stu-id="11412-238">Sign in to the **Azure portal** as a Global Administrator, Security Administrator, or Conditional Access Administrator.</span></span>
2. <span data-ttu-id="11412-239">浏览到“Azure Active Directory”   >   “条件访问”。</span><span class="sxs-lookup"><span data-stu-id="11412-239">Browse to **Azure Active Directory** > **Conditional Access**.</span></span>
3. <span data-ttu-id="11412-240">在策略列表中，选择“基线策略:  最终用户保护(预览)”。</span><span class="sxs-lookup"><span data-stu-id="11412-240">In the list of policies, select **Baseline policy: End user protection (preview)**.</span></span>
4. <span data-ttu-id="11412-241">将“启用策略”设置为“立即使用策略”。  </span><span class="sxs-lookup"><span data-stu-id="11412-241">Set **Enable policy** to **Use policy immediately**.</span></span>
5. <span data-ttu-id="11412-242">单击“保存”。 \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="11412-242">Click **Save**.</span></span>

> [!WARNING]
> <span data-ttu-id="11412-243">在启用此策略之前，请确保用户使用的不是旧版身份验证协议。</span><span class="sxs-lookup"><span data-stu-id="11412-243">Before you enable this policy, make sure your users are not using legacy authentication protocols.</span></span> <span data-ttu-id="11412-244">实施此策略以后，系统会阻止旧版身份验证。</span><span class="sxs-lookup"><span data-stu-id="11412-244">Through the implementation of this policy legacy authentication will be blocked.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="11412-245">这是已知问题，会影响你使用委派的管理权限连接到 Exchange Online PowerShell。</span><span class="sxs-lookup"><span data-stu-id="11412-245">There is a known issues, that impacts your ability to connect to Exchange Online PowerShell using delegated administrative privileges.</span></span> <span data-ttu-id="11412-246">如果使用该 PowerShell 模块，请在启用此策略之前查看 [Exchange Online PowerShell](#exchange-online-powershell) 已知问题。</span><span class="sxs-lookup"><span data-stu-id="11412-246">See the [Exchange Online PowerShell](#exchange-online-powershell) known issue prior to enabling this policy if you using this PowerShell module.</span></span>

## <a name="assessing-your-environment"></a><span data-ttu-id="11412-247">评估环境</span><span class="sxs-lookup"><span data-stu-id="11412-247">Assessing your environment</span></span>

<span data-ttu-id="11412-248">根据当前的一项合作伙伴安全要求，你必须为合作伙伴租户中的每位用户强制实施 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-248">Through one of the current partner security requirements, you are required to have MFA enforced for each user in your partner tenant.</span></span> <span data-ttu-id="11412-249">由于此要求可以通过许多不同的方法来履行，因此可能难以评估是否需要执行额外的操作。</span><span class="sxs-lookup"><span data-stu-id="11412-249">Since this requirement can be fulfilled through a number of different methods it can prove difficult to assess if any additional actions are required.</span></span> <span data-ttu-id="11412-250">可以使用 Azure Active Directory 审核日志和 [Microsoft 安全功能分数](https://docs.microsoft.com/office365/securitycompliance/microsoft-secure-score)之类的工具，以便评估是否需要执行额外的操作才能通过 MFA 来保护租户。</span><span class="sxs-lookup"><span data-stu-id="11412-250">You can leverage tools like the Azure Active Directory audit logs and [Microsoft Secure Score](https://docs.microsoft.com/office365/securitycompliance/microsoft-secure-score) to evaluate if any additional actions are required to secure your tenant with the MFA.</span></span> <span data-ttu-id="11412-251">Microsoft 正在合作伙伴中心构建一项体验，用于针对 MFA 和安全应用程序模型要求进行快速的符合性检查。</span><span class="sxs-lookup"><span data-stu-id="11412-251">Microsoft is working on an experience in Partner Center to provide a quick compliance check on the MFA and the Secure Application Model requirements.</span></span>

<span data-ttu-id="11412-252">Microsoft 安全功能分数提供强大的可视化功能、与其他 Microsoft 产品集成的功能、将你的分数与其他公司的分数进行比较的功能、按类别筛选的功能，等等。</span><span class="sxs-lookup"><span data-stu-id="11412-252">Microsoft Secure Score gives you robust visualizations, integration with other Microsoft products, comparison of your score with other companies, filtering by category, and much more.</span></span> <span data-ttu-id="11412-253">可以使用此工具在组织中完成安全改进操作，并跟踪分数历史记录。</span><span class="sxs-lookup"><span data-stu-id="11412-253">With this tool, you can complete security improvement actions within your organization and track the history of your score.</span></span> <span data-ttu-id="11412-254">此分数也可反映第三方解决方案何时解决了建议的改进操作问题。</span><span class="sxs-lookup"><span data-stu-id="11412-254">The score can also reflect when third-party solutions have addressed recommended improvement actions.</span></span>

![Microsoft 安全功能分数](images/security/secure-score.png)

> [!NOTE]
> <span data-ttu-id="11412-256">系统可能需要长达 24 小时的时间才能反映你可以执行的用于改进 Microsoft 安全功能分数的操作。</span><span class="sxs-lookup"><span data-stu-id="11412-256">Actions you can take to improve your Microsoft Secure Score may take up to 24 hours to be reflected.</span></span>

<span data-ttu-id="11412-257">Microsoft 安全功能分数只是以数字方式体现你的安全态势。</span><span class="sxs-lookup"><span data-stu-id="11412-257">Microsoft Secure Score will only provide a numerical representation of your security posture.</span></span> <span data-ttu-id="11412-258">若要更好地了解哪个帐户或用户在进行身份验证时没有受到 MFA 质询，建议查询 Azure Active Directory 审核日志。</span><span class="sxs-lookup"><span data-stu-id="11412-258">To better understand what or who is authenticating without being challenged for MFA, it is recommended to query the Azure Active Directory audit logs.</span></span> <span data-ttu-id="11412-259">为此，可以使用 [Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview) 模块和下面的脚本。</span><span class="sxs-lookup"><span data-stu-id="11412-259">This can be accomplished using the [Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview) module and the script below.</span></span> <span data-ttu-id="11412-260">这样会生成一个报表，该报表详细说明了过去一天内发生的哪些身份验证尝试没有受到 MFA 质询。</span><span class="sxs-lookup"><span data-stu-id="11412-260">It will generate a report that provides insight into what authentication attempts have occurred over the past day that were not challenged for MFA.</span></span>

```powershell
Login-AzAccount
$context = Get-AzContext

function Get-SignInEvents
{
    param([string]$userId)

    $content = '{"startDateTime":"' + (Get-Date).AddDays(-1).ToUniversalTime().ToString("yyyy-MM-ddT05:00:00.000Z") + '","endDateTime":"' + (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ss.fffZ")  + '","userId":"' + $userId +'","riskState":[],"totalRisk":[],"realtimeRisk":[],"tokenIssuerType":[],"isAdfsEnabled":false}'

    $token = [Microsoft.Azure.Commands.Common.Authentication.AzureSession]::Instance.AuthenticationFactory.Authenticate($context.Account, $context.Environment, $context.Tenant.Id, $null, "Never", $null, "74658136-14ec-4630-ad9b-26e160ff0fc6")

    $headers = @{
    'Authorization' = 'Bearer ' + $token.AccessToken
    'Content-Type' = 'application/json'
        'X-Requested-With'= 'XMLHttpRequest'
        'x-ms-client-request-id'= [guid]::NewGuid()
        'x-ms-correlation-id' = [guid]::NewGuid()
    }

    Invoke-RestMethod -Body $content -Header $headers -Method POST -Uri "https://main.iam.ad.ext.azure.com/api/Reports/SignInEventsV3"
}

$report = $()

Get-AzADUser | foreach {
    $events = Get-SignInEvents $_.Id
    $report += $events.Items
}

$report | Where-Object {$_.mfaRequired -eq $false} | Select-Object userPrincipalName, userDisplayName, createdDateTime, resourceDisplayName, loginSucceeded, failureReason, mfaRequired, mfaAuthMethod, mfaAuthDetail, mfaResult, @{Name='policies'; Expression={[string]::join(',', $($_.conditionalAccessPolicies | Select-Object displayName).displayName )}}, conditionalAccessStatus | Export-Csv report.csv
```

<span data-ttu-id="11412-261">运行以上脚本以后，即可在 report.csv 文件中获取详细信息。</span><span class="sxs-lookup"><span data-stu-id="11412-261">After running the above script, the details will be available in the report.csv file.</span></span> <span data-ttu-id="11412-262">该文件将包含一个列表，列表中的身份验证尝试是过去一天内发生的，相关用户没有受到 MFA 质询。</span><span class="sxs-lookup"><span data-stu-id="11412-262">It will contain a list of authentication attempts that have occurred over the last day where the user was not challenged for MFA.</span></span> <span data-ttu-id="11412-263">你需要查看每个条目，确定其是否为预期的行为，必要时采取行动。</span><span class="sxs-lookup"><span data-stu-id="11412-263">You will need to review each entry to determine if this is the expected behavior and act if necessary.</span></span>

![评估报表](images/security/assessment-report.png)

## <a name="common-issues"></a><span data-ttu-id="11412-265">常见问题</span><span class="sxs-lookup"><span data-stu-id="11412-265">Common issues</span></span>

### <a name="azure-active-directory"></a><span data-ttu-id="11412-266">Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="11412-266">Azure Active Directory</span></span>

#### <a name="aadsts50076"></a><span data-ttu-id="11412-267">AADSTS50076</span><span class="sxs-lookup"><span data-stu-id="11412-267">AADSTS50076</span></span>

<span data-ttu-id="11412-268">在启用基线策略以后，你可能会发现自己的自动化或集成遇到如下所示的异常：</span><span class="sxs-lookup"><span data-stu-id="11412-268">After enabling the baseline policies, you might find that your automation or integration is encountering an exception like the following</span></span>

    AADSTS50076: Due to a configuration change made by your administrator, or because you moved to a new location, you must use multi-factor authentication to access 'MyApp'.

<span data-ttu-id="11412-269">发生此异常的原因是，你在使用用户凭据进行身份验证，而现在需要的是 MFA。</span><span class="sxs-lookup"><span data-stu-id="11412-269">The reason for this exception is that you are authenticating using user credentials and MFA is now required.</span></span> <span data-ttu-id="11412-270">若要解决此异常问题，需要使用访问令牌进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="11412-270">To address this exception, you will need to utilize an access token for authentication.</span></span> <span data-ttu-id="11412-271">有关详细信息，请参阅[安全应用程序模型指南](http://assetsprod.microsoft.com/secure-application-model-guide.pdf)。</span><span class="sxs-lookup"><span data-stu-id="11412-271">See the [Secure Application Model guide](http://assetsprod.microsoft.com/secure-application-model-guide.pdf) for more information.</span></span>

>[!IMPORTANT]
><span data-ttu-id="11412-272">大多数新式 API 和 PowerShell 模块支持使用访问令牌进行身份验证的功能。</span><span class="sxs-lookup"><span data-stu-id="11412-272">Most modern APIs and PowerShell modules support the ability to utilize an access token for authentication.</span></span> <span data-ttu-id="11412-273">不过，也有一些目前不支持此功能。</span><span class="sxs-lookup"><span data-stu-id="11412-273">However, there are some that currently do not support this functionality.</span></span> <span data-ttu-id="11412-274">如果需要他人帮你确定你尝试使用的 API 或 PowerShell 模块是否支持使用访问令牌进行身份验证，则请在[合作伙伴中心安全指南组](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance)社区发布消息。</span><span class="sxs-lookup"><span data-stu-id="11412-274">If you need help determining if the API or PowerShell module you are trying to leverage supports the use of an access token for authentication, then post a message on the [Partner Center Security Guidance Group](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance) community.</span></span>

#### <a name="aadsts700082"></a><span data-ttu-id="11412-275">AADSTS700082</span><span class="sxs-lookup"><span data-stu-id="11412-275">AADSTS700082</span></span>

<span data-ttu-id="11412-276">一旦实现安全应用程序模型框架，则可能会在生成初始刷新令牌 90 天后收到以下异常：</span><span class="sxs-lookup"><span data-stu-id="11412-276">Once you have implemented the Secure Application Model framework there is a chance you will receive the following exception 90 days after generating the initial refresh token</span></span>

    The refresh token has expired due to inactivity. The token was issued on 2019-01-02T09:19:53.5422744Z and was inactive for 90.00:00:00

<span data-ttu-id="11412-277">就 Azure Active Directory 来说，刷新令牌的最长生存期为 90 天。</span><span class="sxs-lookup"><span data-stu-id="11412-277">With respect to Azure Active Directory the maximum lifetime for a refresh token is 90 days.</span></span> <span data-ttu-id="11412-278">若要解决此错误，需生成新的刷新令牌并将其安全地存储。</span><span class="sxs-lookup"><span data-stu-id="11412-278">To address this error, you will need to generate and securely store a new refresh token.</span></span> <span data-ttu-id="11412-279">请注意，可以通过编程方式更新此刷新令牌，因为每次向 Azure Active Directory 请求访问令牌时，都会返回新的刷新令牌。</span><span class="sxs-lookup"><span data-stu-id="11412-279">Note it is possible to update the refresh token programmatically because with each request to Azure Active Directory for an access token a new refresh token is returned.</span></span> <span data-ttu-id="11412-280">可以实现适当的逻辑，在安全存储的刷新令牌过期之前更新它。</span><span class="sxs-lookup"><span data-stu-id="11412-280">You can implement the appropriate logic to update the securely stored refresh token before it expires.</span></span>

<span data-ttu-id="11412-281">有关详细信息，请参阅 [Azure Active Directory 中的可配置令牌生存期](https://docs.microsoft.com/azure/active-directory/develop/active-directory-configurable-token-lifetimes)。</span><span class="sxs-lookup"><span data-stu-id="11412-281">See [Configurable token lifetimes in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-configurable-token-lifetimes) for more information.</span></span>

### <a name="recovering-compromised-accounts"></a><span data-ttu-id="11412-282">恢复被盗用的帐户</span><span class="sxs-lookup"><span data-stu-id="11412-282">Recovering compromised accounts</span></span>

<span data-ttu-id="11412-283">为了保护客户，Microsoft 的泄漏凭据服务会查找公开可用的用户名/密码对。</span><span class="sxs-lookup"><span data-stu-id="11412-283">To help protect our customers, Microsoft’s leaked credential service finds publicly available username/password pairs.</span></span> <span data-ttu-id="11412-284">如果这些用户名/密码对与某位用户匹配，我们会立即对该帐户进行保护。</span><span class="sxs-lookup"><span data-stu-id="11412-284">If they match one of our users, we help secure that account immediately.</span></span> <span data-ttu-id="11412-285">如果确定用户的凭据泄漏，则会将其确认为被盗用用户。</span><span class="sxs-lookup"><span data-stu-id="11412-285">Users identified as having a leaked credential are confirmed compromised.</span></span> <span data-ttu-id="11412-286">系统会阻止这些用户登录，直至其密码被重置。</span><span class="sxs-lookup"><span data-stu-id="11412-286">These users will be blocked from signing in until their password is reset.</span></span>

<span data-ttu-id="11412-287">被分配 Azure AD Premium 许可证的用户可以通过自助式密码重置 (SSPR) 来还原访问权限，前提是该功能已在用户的目录中启用。</span><span class="sxs-lookup"><span data-stu-id="11412-287">Users assigned an Azure AD Premium license can restore access through self-service password reset (SSPR) if the capability is enabled in their directory.</span></span> <span data-ttu-id="11412-288">没有高级许可证却被系统阻止的用户必须联系管理员，让其执行手动密码重置并消除标记的用户风险事件。</span><span class="sxs-lookup"><span data-stu-id="11412-288">Users without a premium license that become blocked must contact an administrator to perform a manual password reset and dismiss the flagged user risk event.</span></span>

#### <a name="steps-to-unblock-a-user"></a><span data-ttu-id="11412-289">取消阻止用户的步骤</span><span class="sxs-lookup"><span data-stu-id="11412-289">Steps to unblock a user</span></span>

<span data-ttu-id="11412-290">检查用户的登录日志，确认用户是否已被策略阻止。</span><span class="sxs-lookup"><span data-stu-id="11412-290">Confirm that the user has been blocked by the policy by examining the user’s sign-in logs.</span></span>

1. <span data-ttu-id="11412-291">管理员需登录到 **Azure 门户**，导航到 **“Azure Active Directory”**  >   “用户”，单击用户的名称，然后导航到“登录”。</span><span class="sxs-lookup"><span data-stu-id="11412-291">An administrator needs to sign in to the **Azure portal** and navigate to **Azure Active Directory** > **Users** > click on the name of the user and navigate to Sign-ins.</span></span>
2. <span data-ttu-id="11412-292">若要对被阻止的用户启动密码重置，管理员需导航到“Azure Active Directory”   >   “已标记为存在风险的用户”</span><span class="sxs-lookup"><span data-stu-id="11412-292">To initiate password reset on a blocked user, an administrator needs to navigate to **Azure Active Directory** > **Users flagged for risk**</span></span>
3. <span data-ttu-id="11412-293">单击其帐户已被阻止的用户，查看有关此用户的最近登录活动的信息。</span><span class="sxs-lookup"><span data-stu-id="11412-293">Click on the user whose account is blocked to view information about the user’s recent sign-in activity.</span></span>
4. <span data-ttu-id="11412-294">单击“重置密码”，分配一个临时密码，该密码必须在下次登录时更改。</span><span class="sxs-lookup"><span data-stu-id="11412-294">Click Reset Password to assign a temporary password that must be changed upon the next login.</span></span>
5. <span data-ttu-id="11412-295">单击“清除所有事件”，重置用户的风险分数。</span><span class="sxs-lookup"><span data-stu-id="11412-295">Click Dismiss all events to reset the user’s risk score.</span></span>

<span data-ttu-id="11412-296">用户现在可以登录并重置其密码，然后访问应用程序。</span><span class="sxs-lookup"><span data-stu-id="11412-296">The user can now sign in, reset their password, and access the application.</span></span>

## <a name="known-issues"></a><span data-ttu-id="11412-297">已知问题</span><span class="sxs-lookup"><span data-stu-id="11412-297">Known issues</span></span>

### <a name="exchange-online-powershell"></a><span data-ttu-id="11412-298">Exchange Online PowerShell</span><span class="sxs-lookup"><span data-stu-id="11412-298">Exchange Online PowerShell</span></span>

<span data-ttu-id="11412-299">强制实施 MFA 以后，合作伙伴将无法利用其委派的管理权限和 Exchange Online PowerShell 对其客户执行操作。</span><span class="sxs-lookup"><span data-stu-id="11412-299">When MFA is enforced partners will not be able to utilize their delegated administrative privileges with Exchange Online PowerShell to perform actions against their customers.</span></span> <span data-ttu-id="11412-300">有关此限制的详细信息，请参阅[使用多重身份验证连接到 Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/mfa-connect-to-exchange-online-powershell)。</span><span class="sxs-lookup"><span data-stu-id="11412-300">See [Connect to Exchange Online PowerShell using multi-factor authentication](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/mfa-connect-to-exchange-online-powershell) for more information regarding this limitation.</span></span>

<span data-ttu-id="11412-301">若要规避此限制，可以创建一个新帐户，但不使用它来执行交互式身份验证。</span><span class="sxs-lookup"><span data-stu-id="11412-301">You can work around this limitation by creating a new account and never using it to perform an interactive authentication.</span></span> <span data-ttu-id="11412-302">建议使用 [Azure AD PowerShell](https://docs.microsoft.com/powershell/module/azuread/) 来创建此新帐户，然后执行初始配置。</span><span class="sxs-lookup"><span data-stu-id="11412-302">It is recommended that you leverage [Azure AD PowerShell](https://docs.microsoft.com/powershell/module/azuread/) to create the new account and perform the initial configuration.</span></span> <span data-ttu-id="11412-303">以下 PowerShell 可以用来创建并配置此帐户：</span><span class="sxs-lookup"><span data-stu-id="11412-303">The following PowerShell can be used to create and configure the account</span></span>

```powershell
Import-Module AzureAD
Connect-AzureAD

$PasswordProfile = New-Object -TypeName Microsoft.Open.AzureAD.Model.PasswordProfile

$PasswordProfile.Password = "Password"
$PasswordProfile.ForceChangePasswordNextLogin = $false

$user = New-AzureADUser -DisplayName "New User" -PasswordProfile $PasswordProfile -UserPrincipalName "NewUser@contoso.com" -AccountEnabled $true

# Uncomment the following two lines if you want the account to have Admin Agent privileges
# $adminAgentsGroup = Get-AzureADGroup -Filter "DisplayName eq 'AdminAgents'"
# Add-AzureADGroupMember -ObjectId $adminAgentsGroup.ObjectId -RefObjectId $user.ObjectId
```

<span data-ttu-id="11412-304">下次通过 PowerShell 连接到 Exchange Online 时，请使用此帐户，它会按预期运行。</span><span class="sxs-lookup"><span data-stu-id="11412-304">Next time you connect to Exchange Online through PowerShell use this account, it will work as expected.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="11412-305">合作伙伴在强制实施 MFA 以后利用其委派的管理权限和 Exchange Online PowerShell 对其客户执行操作的功能将在以后推出。</span><span class="sxs-lookup"><span data-stu-id="11412-305">The ability for partners to utilize their delegated administrative privileges with Exchange Online PowerShell to perform actions against their customers, when MFA is enforced, will be available in the future.</span></span> <span data-ttu-id="11412-306">在此之前，应使用此解决方法。</span><span class="sxs-lookup"><span data-stu-id="11412-306">Until then you should leverage this work around.</span></span>

## <a name="resources-and-support"></a><span data-ttu-id="11412-307">资源和支持</span><span class="sxs-lookup"><span data-stu-id="11412-307">Resources and support</span></span>

<span data-ttu-id="11412-308">可以通过[合作伙伴中心安全指南组社区](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance)查找其他资源，并了解即将发生的事件，例如技术办公时间。</span><span class="sxs-lookup"><span data-stu-id="11412-308">Through the [Partner Center Security Guidance Group community](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance) you can will find additional resources and learn about upcoming events such as technical office hours.</span></span> <span data-ttu-id="11412-309">请参阅[常见问题解答](partner-security-requirements-faq.md)文档，详细了解相关要求。</span><span class="sxs-lookup"><span data-stu-id="11412-309">See the [frequently asked questions](partner-security-requirements-faq.md) document to learn more about the requirements.</span></span>
